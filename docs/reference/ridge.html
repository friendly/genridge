<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ridge Regression Estimates — ridge • genridge</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ridge Regression Estimates — ridge"><meta name="description" content="The function ridge fits linear models by ridge regression, returning
an object of class ridge designed to be used with the plotting
methods in this package.
It is also designed to facilitate an alternative representation
of the effects of shrinkage in the space of uncorrelated (PCA/SVD) components of the predictors.
The standard formulation of ridge regression is that it regularizes the estimates of coefficients
by adding small positive constants \(\lambda\) to the diagonal elements of \(\mathbf{X}^\top\mathbf{X}\) in
the least squares solution to achieve a more favorable tradeoff between bias and variance (inverse of precision)
of the coefficients.
$$\widehat{\mathbf{\beta}}^{\text{RR}}_k  = (\mathbf{X}^\top \mathbf{X} + \lambda \mathbf{I})^{-1} \mathbf{X}^\top \mathbf{y}  $$
Ridge regression shrinkage can be parameterized in several ways.
If a vector of lambda values is supplied, these are used directly in the ridge regression computations.
Otherwise, if a vector df can be supplied the equivalent values for effective degrees of freedom corresponding to shrinkage,
         going down from the number of predictors in the model.


In either case, both lambda and
df are returned in the ridge object, but the rownames of the
coefficients are given in terms of lambda."><meta property="og:description" content="The function ridge fits linear models by ridge regression, returning
an object of class ridge designed to be used with the plotting
methods in this package.
It is also designed to facilitate an alternative representation
of the effects of shrinkage in the space of uncorrelated (PCA/SVD) components of the predictors.
The standard formulation of ridge regression is that it regularizes the estimates of coefficients
by adding small positive constants \(\lambda\) to the diagonal elements of \(\mathbf{X}^\top\mathbf{X}\) in
the least squares solution to achieve a more favorable tradeoff between bias and variance (inverse of precision)
of the coefficients.
$$\widehat{\mathbf{\beta}}^{\text{RR}}_k  = (\mathbf{X}^\top \mathbf{X} + \lambda \mathbf{I})^{-1} \mathbf{X}^\top \mathbf{y}  $$
Ridge regression shrinkage can be parameterized in several ways.
If a vector of lambda values is supplied, these are used directly in the ridge regression computations.
Otherwise, if a vector df can be supplied the equivalent values for effective degrees of freedom corresponding to shrinkage,
         going down from the number of predictors in the model.


In either case, both lambda and
df are returned in the ridge object, but the rownames of the
coefficients are given in terms of lambda."><meta property="og:image" content="https://friendly.github.io/genridge/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">genridge</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/genridge/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Ridge Regression Estimates</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/genridge/blob/HEAD/R/ridge.R" class="external-link"><code>R/ridge.R</code></a></small>
      <div class="d-none name"><code>ridge.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>ridge</code> fits linear models by ridge regression, returning
an object of class <code>ridge</code> designed to be used with the plotting
methods in this package.</p>
<p>It is also designed to facilitate an alternative representation
of the effects of shrinkage in the space of uncorrelated (PCA/SVD) components of the predictors.</p>
<p>The standard formulation of ridge regression is that it regularizes the estimates of coefficients
by adding small positive constants \(\lambda\) to the diagonal elements of \(\mathbf{X}^\top\mathbf{X}\) in
the least squares solution to achieve a more favorable tradeoff between bias and variance (inverse of precision)
of the coefficients.</p>
<p>$$\widehat{\mathbf{\beta}}^{\text{RR}}_k  = (\mathbf{X}^\top \mathbf{X} + \lambda \mathbf{I})^{-1} \mathbf{X}^\top \mathbf{y}  $$</p>
<p>Ridge regression shrinkage can be parameterized in several ways.</p><ul><li><p>If a vector of <code>lambda</code> values is supplied, these are used directly in the ridge regression computations.</p></li>
<li><p>Otherwise, if a vector <code>df</code> can be supplied the equivalent values for effective degrees of freedom corresponding to shrinkage,
         going down from the number of predictors in the model.</p></li>
</ul><p>In either case, both <code>lambda</code> and
<code>df</code> are returned in the <code>ridge</code> object, but the <code>rownames</code> of the
coefficients are given in terms of <code>lambda</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ridge</span><span class="op">(</span><span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">ridge</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, lambda <span class="op">=</span> <span class="fl">0</span>, <span class="va">df</span>, svd <span class="op">=</span> <span class="cn">TRUE</span>, contrasts <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">ridge</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, lambda <span class="op">=</span> <span class="fl">0</span>, <span class="va">df</span>, svd <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'ridge'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'ridge'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'ridge'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric vector containing the response variable. NAs not allowed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments, passed down to methods</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>For the <code>formula</code> method, a two-sided formula.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>For the <code>formula</code> method, data frame within which to
evaluate the formula.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A scalar or vector of ridge constants. A value of 0
corresponds to ordinary least squares.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>A scalar or vector of effective degrees of freedom corresponding
to <code>lambda</code></p></dd>


<dt id="arg-svd">svd<a class="anchor" aria-label="anchor" href="#arg-svd"></a></dt>
<dd><p>If <code>TRUE</code> the SVD of the centered and scaled <code>X</code> matrix
is returned in the <code>ridge</code> object.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>a list of contrasts to be used for some or all of factor terms in the formula.
See the <code>contrasts.arg</code> of <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix.default</a></code>.</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A matrix of predictor variables. NA's not allowed. Should not
include a column of 1's for the intercept.</p></dd>


<dt id="arg-x-object">x, object<a class="anchor" aria-label="anchor" href="#arg-x-object"></a></dt>
<dd><p>An object of class <code>ridge</code></p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>For the <code>print</code> method, the number of digits to print.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p>
<dl><dt>lambda</dt>
<dd><p>The vector of ridge constants</p></dd>

<dt>df</dt>
<dd><p>The vector of effective degrees of freedom corresponding to <code>lambda</code></p></dd>

<dt>coef</dt>
<dd><p>The matrix of estimated ridge regression coefficients</p></dd>

<dt>scales</dt>
<dd><p>scalings used on the X matrix</p></dd>

<dt>kHKB</dt>
<dd><p>HKB estimate of the ridge constant</p></dd>

<dt>kLW</dt>
<dd><p>L-W estimate of the ridge constant</p></dd>

<dt>GCV</dt>
<dd><p>vector of GCV values</p></dd>

<dt>kGCV</dt>
<dd><p>value of <code>lambda</code> with the minimum GCV</p></dd>

<dt>criteria</dt>
<dd><p>Collects the criteria <code>kHKB</code>, <code>kLW</code>, and <code>kGCV</code> in a named vector</p></dd>


</dl><p>If <code>svd==TRUE</code> (the default), the following are also included:</p>
<dl><dt>svd.D</dt>
<dd><p>Singular values of the <code>svd</code> of the scaled X matrix</p></dd>

<dt>svd.U</dt>
<dd><p>Left singular vectors of the <code>svd</code> of the scaled X matrix.
      Rows correspond to observations and columns to dimensions.</p></dd>

<dt>svd.V</dt>
<dd><p>Right singular vectors of the <code>svd</code> of the scaled X
      matrix. Rows correspond to variables and columns to dimensions.</p></dd>
 </dl><p><!-- %% ... --></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If an intercept is present in the model, its coefficient is not penalized. (If you want to penalize
an intercept, put in your own constant term and remove the intercept.)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hoerl, A. E., Kennard, R. W., and Baldwin, K. F. (1975), "Ridge
Regression: Some Simulations," <em>Communications in Statistics</em>, 4,
105-123.</p>
<p>Lawless, J.F., and Wang, P. (1976), "A Simulation Study of Ridge and Other
Regression Estimators," <em>Communications in Statistics</em>, 5, 307-323.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">lm.ridge</a></code> for other implementations of ridge regression</p>
<p><code><a href="traceplot.html">traceplot</a></code>, <code><a href="plot.ridge.html">plot.ridge</a></code>,
<code><a href="pairs.ridge.html">pairs.ridge</a></code>, <code><a href="plot3d.html">plot3d.ridge</a></code>, for 1D, 2D, 3D plotting methods</p>
<p><code><a href="pca.html">pca.ridge</a></code>, <code><a href="biplot.pcaridge.html">biplot.ridge</a></code>,
<code><a href="biplot.pcaridge.html">biplot.pcaridge</a></code> for views in PCA/SVD space</p>
<p><code><a href="precision.html">precision.ridge</a></code> for measures of shrinkage and precision</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#\donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Longley data, using number Employed as response</span></span></span>
<span class="r-in"><span><span class="va">longley.y</span> <span class="op">&lt;-</span> <span class="va">longley</span><span class="op">[</span>, <span class="st">"Employed"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">longley.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">longley</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.08</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lridge</span> <span class="op">&lt;-</span> <span class="fu">ridge</span><span class="op">(</span><span class="va">longley.y</span>, <span class="va">longley.X</span>, lambda<span class="op">=</span><span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same, using formula interface</span></span></span>
<span class="r-in"><span><span class="va">lridge</span> <span class="op">&lt;-</span> <span class="fu">ridge</span><span class="op">(</span><span class="va">Employed</span> <span class="op">~</span> <span class="va">GNP</span> <span class="op">+</span> <span class="va">Unemployed</span> <span class="op">+</span> <span class="va">Armed.Forces</span> <span class="op">+</span> <span class="va">Population</span> <span class="op">+</span> <span class="va">Year</span> <span class="op">+</span> <span class="va">GNP.deflator</span>, </span></span>
<span class="r-in"><span>    data<span class="op">=</span><span class="va">longley</span>, lambda<span class="op">=</span><span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lridge</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              GNP Unemployed Armed.Forces  Population     Year GNP.deflator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.000 -3.4471925  -1.827886   -0.6962102 -0.34419721 8.431972   0.15737965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.005 -1.0424783  -1.491395   -0.6234680 -0.93558040 6.566532  -0.04175039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.010 -0.1797967  -1.361047   -0.5881396 -1.00316772 5.656287  -0.02612152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.020  0.4994945  -1.245137   -0.5476331 -0.86755299 4.626116   0.09766305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.040  0.9059471  -1.155229   -0.5039108 -0.52347060 3.576502   0.32123994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.080  1.0907048  -1.086421   -0.4582525 -0.08596324 2.641649   0.57025165</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># standard trace plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">lridge</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># plot vs. equivalent df</span></span></span>
<span class="r-in"><span><span class="fu"><a href="traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">lridge</span>, X<span class="op">=</span><span class="st">"df"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">lridge</span>, radius<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prostate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">py</span> <span class="op">&lt;-</span> <span class="va">prostate</span><span class="op">[</span>, <span class="st">"lpsa"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">prostate</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pridge</span> <span class="op">&lt;-</span> <span class="fu">ridge</span><span class="op">(</span><span class="va">py</span>, <span class="va">pX</span>, df<span class="op">=</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pridge</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ridge Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            lcavol      lweight     age         lbph        svi       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.00000   0.6617092   0.2651031  -0.1573777   0.1395860   0.3136993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7.08544   0.5774912   0.2574888  -0.1240459   0.1239824   0.2825540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17.80389   0.4966273   0.2435259  -0.0910692   0.1087544   0.2542261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34.68940   0.4182786   0.2224269  -0.0591493   0.0936983   0.2271752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  62.98554   0.3413151   0.1935614  -0.0296600   0.0784146   0.1988651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115.28893   0.2641305   0.1565931  -0.0049775   0.0622832   0.1660546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 230.11308   0.1842675   0.1116128   0.0112850   0.0444562   0.1249585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 601.44017   0.0979221   0.0591504   0.0144649   0.0239578   0.0711874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            lcp         gleason     pgg45     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.00000  -0.1475193   0.0353655   0.1250701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7.08544  -0.0556184   0.0457910   0.0958079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17.80389   0.0159166   0.0518160   0.0800300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34.68940   0.0670223   0.0559538   0.0738953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  62.98554   0.0979877   0.0592922   0.0732073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115.28893   0.1087550   0.0607835   0.0729838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 230.11308   0.0981548   0.0564920   0.0666687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 601.44017   0.0633002   0.0392473   0.0455834</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pridge</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">pridge</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">pridge</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">pridge</span>, X<span class="op">=</span><span class="st">"df"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Hospital manpower data from Table 3.8 of Myers (1990) </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Manpower</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Manpower</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	17 obs. of  6 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Hours  : num  567 697 1033 1604 1611 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Load   : num  15.6 44 20.4 18.7 49.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Xray   : int  2463 2048 3940 6505 5723 11520 5779 5969 8461 20106 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BedDays: num  473 1340 620 568 1498 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ AreaPop: num  18 9.5 12.8 36.7 35.7 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Stay   : num  4.45 6.92 4.28 3.9 5.5 4.6 5.62 5.15 6.18 6.15 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Hours</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">Manpower</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">vif</span><span class="op">(</span><span class="va">mmod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Load        Xray     BedDays     AreaPop        Stay </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9597.570761    7.940593 8933.086501   23.293856    4.279835 </span>
<span class="r-in"><span><span class="co"># ridge regression models, specified in terms of equivalent df</span></span></span>
<span class="r-in"><span><span class="va">mridge</span> <span class="op">&lt;-</span> <span class="fu">ridge</span><span class="op">(</span><span class="va">Hours</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">Manpower</span>, df<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3.75</span>, <span class="op">-</span><span class="fl">.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">vif</span><span class="op">(</span><span class="va">mridge</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Load     Xray     BedDays   AreaPop     Stay</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0000000000 9597.570762 7.940593 8933.086501 23.293856 4.279835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0002836352 5602.507260 7.927390 5215.176404 19.045017 3.923247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0009043689 2438.603928 7.912946 2270.761610 15.667945 3.638481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0026667276  634.529233 7.890568  591.831974 13.699280 3.467754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0203643899   23.623930 7.715258   23.249737 12.530582 3.312552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1364900421    7.336948 6.733109    8.136369  9.838466 2.795880</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># univariate ridge trace plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">mridge</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">mridge</span>, X<span class="op">=</span><span class="st">"df"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># bivariate ridge trace plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mridge</span>, radius<span class="op">=</span><span class="fl">0.25</span>, labels<span class="op">=</span><span class="va">mridge</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">mridge</span>, radius<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3D views</span></span></span>
<span class="r-in"><span><span class="co"># ellipsoids for Load, Xray &amp; BedDays are nearly 2D</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">mridge</span>, radius<span class="op">=</span><span class="fl">0.2</span>, labels<span class="op">=</span><span class="va">mridge</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># variables in model selected by AIC &amp; BIC</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">mridge</span>, variables<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, radius<span class="op">=</span><span class="fl">0.2</span>, labels<span class="op">=</span><span class="va">mridge</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plots in PCA/SVD space</span></span></span>
<span class="r-in"><span><span class="va">mpridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="pca.html">pca</a></span><span class="op">(</span><span class="va">mridge</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">mpridge</span>, X<span class="op">=</span><span class="st">"df"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">mpridge</span>, radius<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ridge-13.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vector scale factor set to  8774.365 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

